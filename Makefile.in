################################################################
###
###			       Makefile
###
###	      Copyright (C) 1997  Internet Message Group
###
###		     This Perl5 library conforms
###		GNU GENERAL PUBLIC LICENSE Version 2.
###
###
### Author:  Internet Message Group <img@mew.org>
### Created: April 23, 1997
### Revised: @im_revised@
###

srcdir=	@srcdir@
INSTALL=@INSTALL@
SHELL = /bin/sh

chmod=	@im_path_chmod@
cp=	@im_path_cp@
mkdir=	@im_path_mkdir@
rm=	@im_path_rm@

prefix=	@prefix@
bindir=	@bindir@
libdir=	@libdir@/im
mandir=	@mandir@
exec_prefix=@exec_prefix@
siteperl=@im_path_siteperl@
imdir=$(siteperl)/IM
RPOP=@im_rpop@

PROG = imali imcat imcd imclean imgrep imhist imjoin imls immv \
	impack impath imput impwagent imrm imsetup imsort imstore \
	imtar
all:
	@echo everything has been done by configure.
	@echo you only need to do "make install".

install:: installbin installdata

installbin::
	[ -d $(bindir) ] || \
		($(mkdir) -p $(bindir) && $(chmod) 755 $(bindir))
	for f in $(PROG); do \
		$(INSTALL) -m 555 $${f} $(bindir); done
	$(INSTALL) $(RPOP) imget $(bindir)

installdata::
	[ -d $(imdir) ] || \
		($(mkdir) -p $(imdir) && $(chmod) 755 $(imdir))
	$(cp) -r IM/* $(imdir)
	$(chmod) -R 644 $(imdir)/*
	$(chmod) 755 $(imdir)
	[ -d $(libdir) ] || \
		($(mkdir) -p $(libdir) && $(chmod) 755 $(libdir))
	for cnf_im in SiteConfig ; do \
		if test ! -f $(libdir)/$$cnf_im; then \
			($(cp) $(srcdir)/cnf.im/$$cnf_im $(libdir)) ; \
		else \
			($(cp) $(srcdir)/cnf.im/$$cnf_im $(libdir)/$$cnf_im.new) ; \
		fi ;\
	done
	$(chmod) -R 644 $(libdir)/*
	$(chmod) 755 $(libdir)

clean::
	$(rm) -f $(PROG) imget
	$(rm) -rf IM
	$(mkdir) IM

distclean:: clean
	$(rm) -f Makefile config.log config.status config.cache
